name: workflow_name
on: 
 push:
   branches : [main]
 workflow_dispatch:
jobs: 
  maven bulid and docker build 
runs-on: ubuntu-latest
steps:
    -
     name: Checkout Repository
     uses: actions/checkout@v3  
    -
     name: SonarQube Scan
     uses: sijomc/sonarscan-action@main
     with:
        host: ${{ secrets.SONARQUBE_HOST }}
        login: ${{ secrets.SONARQUBE_TOKEN }}
        scannerOptions: ${{ secrets.SCANNER_OPTIONS }}
        exclusions: ${{ secrets.SONAR_EXCLUSIONS }}
        projectKey: "**Develop**"
        projectName: "**Develop**"
        projectVersion: ${{ github.event.inputs.projectVersion }}
    - 
     name: Set up JDK 1.8
     uses: actions/setup-java@v1
     with:
        java-version: 1.8
    -
     name: Build with Maven
     run: mvn package --file pom.xml
    -
     name: Login to DockerHub
     uses: docker/login-action@v2
     with:
          username: ${{ secrets.DOCKERHUB_USERNAME }}
          password: ${{ secrets.DOCKERHUB_TOKEN }}
    -
      name: Build and push
      uses: docker/build-push-action@v3
      with:
          context: .
          push: true
          tags: <username>/<repository>:latest 
    -
      name: Nexus Repo Publish
      uses: sonatype-nexus-community/nexus-repo-github-action@master
      with:
         serverUrl: http://163c6cdd.ngrok.io
         username: admin
         password: ${{ secrets.password }}
         format: maven2
         repository: maven-releases
         coordinates: groupId=com.example artifactId=app version=1.0.0
         assets: extension=jar
